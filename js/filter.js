importScripts("b58.js","//cdn.jsdelivr.net/npm/remarkable@2.0.1/dist/remarkable.min.js");const imgHoster="https://images.ecency.com";var md=new remarkable.Remarkable({html:!0});function filter(t,e){for(counter=0;counter<t.length;)void 0===t[counter]||void 0===JSON.parse(t[counter].json_metadata).image?console.log("undefined at filter:filter.js"):"feed"===e&&"trhome"==t[counter].category||"trvideo"==t[counter].category?pushy(t,"home"):"new"===e?pushy(t,"discover"):console.log(counter),counter+=1}function pushy(t,e){var a,r,o=JSON.parse(t[counter].json_metadata);o.video?(r=o.video[0],a="vid"):r=o.image.toString();var s='<div class="mx-auto card mb-3 bg-white shadow w-max-42"><div class="card-body"><img class="rounded-circle float-start" src="'+imgHoster+"/u/"+t[counter].author+'/avatar/small" alt="user image" height="36" width="36"><a href="?u='+t[counter].author+'" class="tr-username-link card-title fs-6 fw-bold float-start link-dark text-decoration-none" style="margin-left: 3vmin; margin-top: 5px;" id="author-'+counter+e.id+'" data-tr-permlink="'+t[counter].permlink+'">'+t[counter].author+'</a><div style="height: 36px; width: 36px;" class="dot rounded-circle float-end dropdown"><a href="#" id="dropdownMenuLink" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><svg width="36" height="26" fill="dark" style="margin-top: 5px"><use href="#bi-three-dots"/></svg></a><ul class="dropdown-menu-end dropdown-menu"><li><a class="dropdown-item" target="_blank" rel="noopener" href="https://buymeberri.es/@'+t[counter].author+'">Tip Author</a></li><li><a class="dropdown-item" href="#reblogPop" data-bs-toggle="modal" data-tr-permlink="'+t[counter].permlink+'" data-tr-author="'+t[counter].author+'">Reblog</a></li><li><a class="dropdown-item" href="#sharePop" data-bs-toggle="modal" data-tr-url="'+t[counter].url+'">Share</a></li><li><hr class="dropdown-divider"></li><li><a class="dropdown-item text+-danger disabled" href="#mutePop" data-bs-toggle="modal">Mute Post</a></li></ul></div></div><img src="'+imgHoster+"/p/"+b58(o.image[0])+'/?format=webp&mode=fit&width=800" data-tr-src="'+r+'" data-tr-type="'+a+'" alt="Image not found" data-tr-author="'+t[counter].author+'" data-tr-permlink="'+t[counter].permlink+'" data-tr-vote="'+t[counter].active_votes.length+'" data-tr-children="'+t[counter].children+'" data-tr-body="'+o.description+'" data-bs-toggle="modal" data-bs-target="#post-tray"><div class="card-body border-bottom"><svg width="22" height="22" fill="currentColor" class="bi bi-heart" id="like-'+counter+e.id+'" onclick="like(this.id)"><use href="#bi-heart"/></svg><span id="like-count-'+counter+e.id+'" class="ms-2">'+t[counter].active_votes.length+'</span><svg  width="22" height="22" fill="currentColor" class="bi bi-chat-square ms-3"><use href="#bi-chat-square"/></svg><span class="ms-2">'+t[counter].children+'</span><svg width="22" height="22" fill="currentColor" class="bi bi-arrow-return-right ms-3"><use href="#bi-arrow-return-right"/></svg></div><div class="card-body text-center"><p class="card-text lead">'+md.render(o.description)+'</p><span class="link-primary satisfy tr-tag">#'+o.tags.toString().replaceAll(",",' </span><span class="link-primary tr-tag">#')+'</span></span></p><p class="card-text text-center"><small class="text-muted satisfy">Last updated '+timeDiff(t[counter].last_update)+"</small></p></div></div>";postMessage([s,e])}md.use(remarkable.linkify),addEventListener("message",function(t){const[e,a]=t.data;filter(e,a)});